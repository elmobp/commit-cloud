function render(a){$("#cloud").jQCloud(a),$("#filter-container").removeClass("hide")}function commitsLink(a){return a=a.replace(/.*github.com[\/:](.*?)(\.git)?$/,"$1"),a=a.match(/(.*?)\/(.*?)$/),a?{user:a[1],repo:a[2]}:void 0}function error(a){console&&console.log&&console.log("Error getting comments. Response:"+a),$("#repo").fadeIn(),$("#filter").select2("enable",!1),render([{text:"not found",weight:10},{text:"404",weight:10},{text:"error",weight:9},{text:"blunder",weight:8},{text:"mistake",weight:7},{text:"goof",weight:6},{text:"boo-boo",weight:6},{text:"slip-up",weight:6},{text:"miscalculation",weight:5},{text:"whoopsies",weight:5},{text:"inaccuracy",weight:4},{text:"try again",weight:3},{text:"accident",weight:2},{text:"fault",weight:1},{text:"flub",weight:1}])}function error403(){$("#repo").fadeIn(),$("#filter").select2("enable",!1),render([{text:"forbidden",weight:10},{text:"403",weight:10},{text:"max queries exceeded",weight:9},{text:"try again later",weight:9},{text:"error",weight:8},{text:"goof",weight:6},{text:"boo-boo",weight:6},{text:"slip-up",weight:6},{text:"miscalculation",weight:5},{text:"whoopsies",weight:5},{text:"inaccuracy",weight:4},{text:"try again",weight:3},{text:"accident",weight:2},{text:"fault",weight:1},{text:"flub",weight:1}])}function addWord(a,b){if(b=b.toLowerCase(),!hash1.test(b)&&!hash2.test(b)&&!(hashReference.test(b)||(b=b.replace(punctuation,""),stopWords.test(b)||b.length<2))){for(var c in excludes)if(b===excludes[c].toLowerCase())return;a[b]?a[b].weight++:a[b]={text:b,weight:1,html:{title:"Click to filter this keyword","data-value":b}}}}function parseCommits(){var a,b={};for(var c in commits){a=commits[c].commit.message;var d=a.split(wordSeparators);for(var e in d)addWord(b,d[e])}return b=$.map(b,function(a){return a}),b=b.sort(function(a,b){return b.weight-a.weight}),b=b.splice(0,200)}function loadCloud(){github.getLastCommits().done(function(a){if(a instanceof Array&&a.length>0){commits=a;var b=parseCommits();render(b)}else error(a)}).fail(function(a){a&&403===a.status?error403():error()})}function initialize(){$(window).on("hashchange",function(){return window.location.reload()}),$("#repo").submit(function(a){a.preventDefault();var b=commitsLink(this.repo.value);b&&(window.history.pushState(void 0,void 0,"#"+b.user+"/"+b.repo),github=new GithubCommits(b.user,b.repo),$("#cloud").jQCloud("destroy"),loadCloud(b),$(this).fadeOut())}),$("#cloud").on("click",'span[class^="w"]',function(){var a=$("#filter").select2("val"),b=$(this).data("value");a.push(b),$("#filter").select2("val",a),$("#filter").trigger("change")}),$("#filter").select2({tags:function(){var a=parseCommits();return $.map(a,function(a){return a.text})},tokenSeparators:[","," "]}),$("#filter").change(function(){excludes=$("#filter").select2("val");var a=parseCommits();$("#cloud").jQCloud("destroy"),a.length>0?render(a):error("no words found")});var a=getRepoUrlFromHash();a?(github=new GithubCommits(a.user,a.repo),loadCloud(a)):$("#repo").fadeIn()}var GithubCommits=function(){"use strict";var a,b,c,d,e,f,g,h=function(a,b,c){d=a,e=b;var g={};f=$.extend({},g,c),this.initialize()};return h.prototype={initialize:function(){a=null,g=[],b=new Octokit,c=this.getRepo()},getRepo:function(){return b.getRepo(d,e)},getLastCommits:function(){var a=new jQuery.Deferred;return g&&0!==g.length?a.resolve(g):c.getCommits({per_page:100}).done(function(b){b instanceof Array&&(g=b),a.resolve(g)}).fail(function(b){a.reject(b)}),a}},h}(),commits,github,excludes=[],stopWords=/^(i|me|my|myself|we|us|our|ours|ourselves|you|your|yours|yourself|yourselves|he|him|his|himself|she|her|hers|herself|it|its|itself|they|them|their|theirs|themselves|what|which|who|whom|whose|this|that|these|those|am|is|are|was|were|be|been|being|have|has|had|having|do|does|did|doing|will|would|should|can|could|ought|i'm|you're|he's|she's|it's|we're|they're|i've|you've|we've|they've|i'd|you'd|he'd|she'd|we'd|they'd|i'll|you'll|he'll|she'll|we'll|they'll|isn't|aren't|wasn't|weren't|hasn't|haven't|hadn't|doesn't|don't|didn't|won't|wouldn't|shan't|shouldn't|can't|cannot|couldn't|mustn't|let's|that's|who's|what's|here's|there's|when's|where's|why's|how's|a|an|the|and|but|if|or|because|as|until|while|of|at|by|for|with|about|against|between|into|through|during|before|after|above|below|to|from|up|upon|down|in|out|on|off|over|under|again|further|then|once|here|there|when|where|why|how|all|any|both|each|few|more|most|other|some|such|no|nor|not|only|own|same|so|than|too|very|say|says|said|shall)$/,punctuation=/[!"&()*+,-\.\/:;<=>?\[\\\]^`\{|\}~]+/g,wordSeparators=/[\s]+/g,hash1=/[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}/g,hash2=/[a-z0-9]{40}/g,hashReference=/[\S]+@[\d]{5}/g,getRepoUrlFromHash=function(){var a;return a=window.location.hash.match(/#(.*?)\/(.*?)$/),a?{user:a[1],repo:a[2]}:void 0};$(function(){initialize()});